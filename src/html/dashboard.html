<!-- src/html/dashboard.html -->
<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard de Usuario</title>
  <link rel="stylesheet" href="../css/main.css" />
  <link rel="stylesheet" href="../css/dashboard.css" />
</head>

<body>
  <div class="container">
    <h1>Dashboard de Usuario</h1>

    <div class="dashboard-tabs">
      <button class="tab-button active" data-tab="account-overview">
        Mi Cuenta
      </button>
      <button class="tab-button" data-tab="account-settings">
        Configuración de Cuenta
      </button>
    </div>

    <div id="account-overview" class="tab-pane active">
      <div class="info-section">
        <h2>Información General</h2>
        <p>
          Bienvenido, <strong id="userName">Cargando...</strong>.
        </p>
        <p>
          Estado de Acceso API:
          <strong id="apiAccessStatus">Cargando...</strong>
        </p>
      </div>

      <div class="action-section" style="display: none;">
        <h2>Acceso Programático (JWT)</h2>
        <p class="message" id="jwtMessage"></p>
        <button id="getJwtBtn">Obtener JWT</button>
        <div id="jwtTokenDisplay" class="jwt-display">
          <code></code>
          <button id="copyJwtBtn" class="hidden">Copiar</button>
        </div>
      </div>

      <div class="api-info" style="display: none;">
        <h3>¿Cómo usar la API?</h3>
        <p>
          Si obtuviste un JWT, úsalo en el encabezado
          <code>Authorization: Bearer &lt;TU_TOKEN_AQUI&gt;</code>
          para todas las solicitudes a la API.
        </p>
        <pre>
            <code>
              fetch('/api/files/upload', {
                method: 'POST',
                headers: {
                  'Authorization': `Bearer TU_JWT_AQUI`
                },
                body: formData
              });
            </code>
          </pre>
        <p>Para descargar archivos, puedes usar las siguientes rutas:</p>
        <pre>
            <code>
              /api/files/:jobId/download
              /api/files/:jobId/errors
            </code>
          </pre>
      </div>
    </div>

    <div id="account-settings" class="tab-pane">
      <div class="info-section">
        <h2>Detalles de Cuenta</h2>
        <p id="googleLinkedStatus" style="display: none;">Google vinculado: Cargando...</p>
        <p id="passwordSetStatus">Contraseña establecida: Cargando...</p>
      </div>

      <div class="action-section">
        <h3>Añadir / Cambiar Contraseña</h3>
        <p id="passwordMessage" class="message"></p>
        <div class="form-group">
          <label for="currentPassword">Contraseña Actual (si ya tiene una):</label>
          <input type="password" id="currentPassword" placeholder="Contraseña Actual" autocomplete="current-password" />
        </div>
        <div class="form-group">
          <label for="newPassword">Nueva Contraseña:</label>
          <input type="password" id="newPassword" placeholder="Nueva Contraseña" autocomplete="new-password" />
        </div>
        <button id="setPasswordBtn">Establecer / Cambiar Contraseña</button>
      </div>

      <div class="action-section" style="margin-top: 20px; display: none;">
        <h3>Vincular / Desvincular Cuenta de Google</h3>
        <p id="googleMessage" class="message"></p>
        <button id="linkGoogleBtn" class="google-link-btn" onclick="window.location.href='/auth/google?link=true'">
          Vincular con Google
        </button>
        <button id="unlinkGoogleBtn" class="hidden">
          Desvincular Google
        </button>
      </div>
    </div>

    <div class="dashboard-nav">
      <a href="/file-conversion" class="api-link">Ir a Conversión de Archivos</a>
      <a href="/admin-dashboard" id="adminLink" class="admin-link hidden">Panel de Administración</a>
      <button onclick="window.location.href='/auth/logout'" class="logout-btn">
        Cerrar Sesión
      </button>
    </div>
  </div>

  <script type="module" src="../js/dashboard.js"></script>
</body>

</html>